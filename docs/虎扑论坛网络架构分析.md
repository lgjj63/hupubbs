# 虎扑论坛网络架构分析

本文档描述了对虎扑论坛网络架构的分析，作为虎扑论坛爬虫hupubbs的设计依据。

## 用户

每个用户的身份标识有

|标识|说明
|---|---
|ID|帖子里用户头像带有指向用户空间的链接https://my.hupu.com/`user_id`。一大串纯数字。
|个性化ID|用户空间https://my.hupu.com/`user_id`会自动跳转到https://my.hupu.com/`user_customized_id`。并不是每个用户都有。
|昵称|显示在帖子用户头像右边的名字。

## 帖子

虎扑页面显示的内容是渲染过后的。表面静态页面上的文本，后台数据库里未必有。

### 楼层数

楼层从1开始逐渐递增，每页20楼；如果某个回帖被删了，后续所有楼层都会依次递进一位，而不会发生楼层被跳过。这说明“第几楼”并不是回帖的本质属性。推测虎扑渲染器是将一个帖子的所有回帖按照发布时间排序后临时分配楼层数的。

回帖可以引用一个现有的回复，但并没有指向被引用楼层的URL，而是用纯文本写了“引用X楼”。这个X肯定不是原模原样在数据库里的，因为一删回复就要大规模变动后续所有引用关系。